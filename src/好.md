
# **🛠️ 外接硬碟自動化整理工具：專業版規格書 v3.0**

## **1. 核心產品定位**

本工具專為處理「外接硬碟（USB 連接）」開發，針對讀取速度慢、檔案關聯性複雜（Adobe/Web 專案）的痛點，提供具備 **UX 介面**、**安全保護**與**視覺進度**的自動化分析系統。

**典型使用情境**：

- **Scenario A**：多年備份碟，混合 MOV/PSD/AI/ZIP，要快速找可清掉的重複影片。
- **Scenario B**：字型、安裝檔與專案混在一起，要確保專案資料夾完全不動。

**非支援範圍**：

- 不支援解壓縮壓縮檔內容分析。
- 不處理網路磁碟或雲端儲存。
- 單次掃描上限：2TB 或 100萬檔案（超過建議分批）。

***

## **2. 功能模組 (Functional Modules)**

### **🟢 模組 A：互動式選單面板 (User Interface)**

- **功能切換**：Task Mode 下拉選單。
    - 快速索引：僅讀取結構。
    - 深度分析：計算 MD5 指紋進行去重。
    - 安全審計：專注於專案關聯性識別。
- **範圍過濾**：Scan Scope 選單，可選擇全盤或特定分類（影音、字型、安裝檔）。
- **白名單設定**：關鍵字輸入框，動態定義「絕對不可變動」的保護資料夾（支援多行、多資料夾）。


### **🔵 模組 B：即時進度監控 (Real-time Tracker)**

- **動態進度條**：使用 tqdm，顯示：
    - 完成百分比 (Percentage)。
    - 已處理項目數 / 總項目數。
    - 預估剩餘時間 (Estimated Time)。
    - 目前處理速率 (Iterations/sec)。


### **🟡 模組 C：智慧分析引擎 (Analysis Engine)**

- **數位指紋技術**：MD5 演算法，分塊讀取 (Chunk Size: 64KB，可調整)，防止大檔案記憶體溢出。
- **區域標記系統**：根據路徑與副檔名，自動標記 Protected (紅燈) 或 Free (綠燈)。
- **分類規則**：基於副檔名與路徑關鍵字：


| Category | 副檔名範例 | 路徑關鍵字 |
| :-- | :-- | :-- |
| Movie | .mp4, .mov, .mkv | Video, Movies |
| Fonts | .ttf, .otf | Fonts, Typeface |
| Project | .psd, .ai, .html | Projects, Adobe, Web |
| Installer | .exe, .dmg, .msi | Install, Setup |
| Other | - | - |


***

## **3. 資料輸出規格 (Output Specification)**

系統產出 `disk_report.csv` 與 `scan_log.txt`，支援 UTF-8 編碼。

### **CSV 欄位定義**

| 欄位名稱 | 型別 | 說明 | 範例值 | 空值策略 |
| :-- | :-- | :-- | :-- | :-- |
| **Status_Icon** | string | 🔴保護區，🟢安全區 | 🔴 | 必填 |
| **File_Hash** | string | MD5 指紋 | a1b2c3d4... | 必填 |
| **Category** | string | 自動分類 | Movie | 必填 |
| **Is_Duplicate** | bool | 是否重複 | true | 必填 |
| **Size_MB** | float | 大小 (MB) | 1250.5 | 必填 |
| **Action_Suggest** | string | 建議動作 | Move_To_Staging | 必填 |
| **Error_Type** | string | 錯誤類型 (若有) | I/O_Error | 可空 |

**Action_Suggest 可能值**：Keep, Move_To_Staging, Ignore。

### **後續決策輔助**

- 下載後提供「產生搬移腳本」按鈕，輸出 `move_script.bat`（Windows）或 `move_script.sh`（Linux），僅移動 `Action_Suggest != Keep` 的檔案至 `/staging` 資料夾。

***

## **4. 操作流程 (Operation Flow)**

1. **環境預備**：掛載 Google Drive 並連接外接硬碟（路徑輸入框）。
2. **參數設定**：透過 UI 選單設定掃描範圍、白名單、Task Mode。
3. **監控執行**：點擊「開始掃描」，透過進度條即時掌握狀態。
4. **任務結束**：自動顯示報告預覽表格（支援排序/篩選），提供「下載 CSV」與「產生搬移腳本」按鈕。
5. **Resume 功能**：若中斷，檢查 `checkpoint.json`，從上次路徑繼續。

***

## **5. 安全保障條款 (Safety Guardrails)**

- **唯讀原則**：分析階段絕不刪除或移動原始檔案。
- **低電壓保護**：讀取錯誤自動跳過 (Skip)，記錄至 `Error_Type`。
- **錯誤處理**：


| 錯誤類型 | 重試次數 | 動作 |
| :-- | :-- | :-- |
| I/O Error | 3 | Skip 並記錄 |
| Permission Denied | 0 | Skip |
| Timeout | 0 | Skip |

- **跨平台**：使用 `pathlib`，確保 Windows 路徑在 Colab 正確解析。

***

## **6. 技術規格與部署 (Technical Specs)**

- **執行環境**：Google Colab，Python 3.10+。
- **依賴套件**：

```
pip install pandas tqdm pathlib hashlib ipywidgets
```

- **日誌**：`scan_log.txt`，格式：`[TIMESTAMP] [LEVEL] message`，保留最後 10MB。
- **性能參數**：
    - Chunk Size: 64KB。
    - Batch Size: 1000 檔案/批。
- **部署步驟**：

1. 開新 Colab，複製此 Notebook。
2. 執行第一格（安裝依賴 + UI 初始化）。
3. 掛載 Drive，輸入硬碟路徑。
4. 設定參數，開始掃描。

